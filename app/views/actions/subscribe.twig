{% extends "layout.twig" %}

{% block content %}
  <div id="search-container"></div>
  <div id="movies-container"></div>
  <div id="subscribe-container"></div>
{% endblock %}

{% block templates %}
  {{ parent() }}
  <script id="search-template" type="x-handlebars-template">
    {% raw %}
      <form method="post" action="api/search" id="search">
        <fieldset>
          <input type="text" name="title" placeholder="Enter movie title" value="{{title}}" autofocus>
          <input type="submit" value="Search" data-processing="Searching&hellip;">
        </fieldset>
        <p class="error">{{error}}</p>
      </form>
    {% endraw %}
  </script>
  <script id="subscribe-template" type="x-handlebars-template">
    {% raw %}
      {{#if movies}}
        <form method="post" action="api/notifications" id="subscribe">
          <input type="hidden" name="title" value="{{title}}">
          <fieldset>
            <input type="email" name="email" placeholder="Enter your email address" value="{{email}}" autofocus>
            <input type="submit" value="Subscribe" data-processing="Processing&hellip;">
          </fieldset>
          <p class="error">{{error}}</p>
          {{#if success}}
            <p class="success">You have successfuly subscribed to {{movie.title}}!</p>
          {{/if}}
          <p>You will receive email notification a week before premiere. You can <a href="unsubscribe">opt out of notifications</a> in any moment.</p>
        </form>
      {{/if}}
    {% endraw %}
  </script>
{% endblock %}
